{
  "rules": {

    "users": {
      "$uid": {
        ".indexOn": ["phoneNumber", "lastActive"],
        "phoneNumber": {
          ".read": true,
          ".write": false
        },
        "publicProfile": {
          ".read": true,
          ".write": "$uid === auth.uid"
        },
        "serverData": {
          ".read": "$uid === auth.uid",
          ".write": false
        }
      }
    },
    "userContacts": {
      "$uid": {
        ".write": false,
        ".read": "$uid === auth.uid"
      }
    },
    "userRooms": {
      "$uid": {
        "$roomId": {
          ".indexOn": ["lastMessageTimestamp"]
        },
        ".write": false,
        ".read": "$uid === auth.uid"
      }
    },
    "chatRooms": {
      "$roomId": {
        ".write": false,
        ".read": false
      }
    },
    "chatMembers": {
      "$roomId": {
        ".write": false,
        ".read": false
      }
    },
    "chatMessages": {
      "$roomId": {
        "$messageId": {
          ".indexOn": ["timestamp"]
        },
        ".read": "root.child('chatMembers').child($roomId).child(auth.uid).exists()",
        ".write": false
      }
    }
  }
}
